<!DOCTYPE html>
<html lang="en">	
	<head>
        <title>Progressive Pattern Mining Tool</title>
        <meta http-equiv="Content-Type" content="text/html" charset="utf-8">
        <link rel="stylesheet" type="text/css" href="style.css">
        <link href="Vis/vis.css" rel="stylesheet" type="text/css" />
        <link href="noUiSlider/nouislider.css" rel="stylesheet" type="text/css" />
    </head>

<!-- 	<body onload="onLoad();" onresize="onResize();"> 			Uniquement si on utilise la timeline MIT-->
	<body>
	
		<div id="wrapper">
			<div id="banner">
			
				<div><span class="caps">P</span>rogressive <span class="caps">P</span>attern <span class="caps">M</span>ining <span class="caps">T</span>ool</div>
				
				<div id="debugHelp">
					<div><span class="kbShort">H/?</span> : <span class="kbTxt">Exit debug mode</span></div>
					<div><span class="kbShort">S</span> : <span class="kbTxt">Ignore further patterns</span></div>
					<div id="debugHelpPointerTarget"><span class="kbShort">G</span> : <span class="kbTxt">Show pointer target</span></div>
					<div><span class="kbShort">M</span> : <span class="kbTxt">Profile dataset memory</span></div>
					<div id="filler">&nbsp;</div> <!-- Only here to have the background display properly -->
				</div>

				<div id="debugConnexion">
					<div id="connexionTimeDisplay">Connexion&nbsp;&nbsp;&nbsp;&nbsp; : <span>----</span></div>
					<div id="disconnexionTimeDisplay">Disconnexion : <span>----</span></div>
					<div id="lastSentTimeDisplay">Last sent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : <span>----</span></div>
					<div id="lastReceivedTimeDisplay">Last received : <span>----</span></div>
				</div>
			</div>
			<div id="tool">
			
				<div id="left">
					
					<div id="data" class="section">
					
						<div class="title">Data</div>
						
						<ul class="controlTabs">
							<li><a href="javascript:void(0)" class="controlTabLink active" onclick="openControlTab(event, 'Trace')">Trace</a></li>
							<li><a href="javascript:void(0)" class="controlTabLink" onclick="openControlTab(event, 'Events')">Event types</a></li>
							<li><a href="javascript:void(0)" class="controlTabLink" onclick="openControlTab(event, 'Users')">Users</a></li>
							<li><a href="javascript:void(0)" class="controlTabLink" onclick="openControlTab(event, 'Categories')">Categories</a></li>
						</ul>
						
						<div id="Trace" class="controlTabContent defaultControlTab">
							<!-- Info on trace -->
							<div class="subsection">
								<div class="title">This dataset</div>
								<div class="body" id="datasetInfo">
								
								</div>
							</div>
							<!-- <hr>
							<p>You can:</p>
							<button type="button" class='trace-action-button'>Create event</button>
							<button type="button" class='trace-action-button'>Delete event</button>
							<button type="button" class='trace-action-button'>Truncate trace</button>
							<button type="button" class='trace-action-button'>Delete user</button> -->
							<hr>
							<!-- history -->
							<div class="subsection">
								<div class="title">Analysis history</div>
								<div class="body" id="history">
								
								</div>
							</div>
						</div>
						
						<div id="Events" class="controlTabContent">
							<div class="left-aligned">
								Show descriptions:
								<input type="checkbox" class="clickable" id="showEventTypeDescriptionInput" checked onchange="switchShowEventTypeDescription();">
							</div>
						
							<table id="eventTable">
								<thead>
									<tr class="clickable">
										<th onclick="clickOnEventTypeNameHeader()">Event&nbsp;type&nbsp;</th>
										<th id="eventsOccurrencesColumn" onclick="clickOnEventTypeSupportHeader()">Support&nbsp;↑</th>
										<th onclick="clickOnEventTypeCategoryHeader()">Category&nbsp;</th>
									</tr>
								</thead>
								<tbody id="eventTableBody">
								</tbody>
							</table>
							<p id="noEvent">No event available. Try connecting to a server and selecting a dataset.</p>
						</div>
						
						<div id="Users" class="controlTabContent">
							<form>
								<div class="searchBarArea">
									<div class="searchFieldArea">
										&nbsp;
										<input type="text" class="searchField" placeholder="Write user names here">
										<input type="text" class="hidden" disabled>
										<div class="suggestionDiv"></div>
									</div>
								</div>
							</form>
							
							<div id="userTableArea">
								<table id="userTable">
									<thead>
										<tr class="clickable">
											<th onclick="clickOnUserNameHeader()">User&nbsp;</th>
											<th id="eventsPerUserColumn" onclick="clickOnUserNbEventsHeader()">Nb&nbsp;events&nbsp;↑</th>
											<th onclick="clickOnUserDurationHeader()">Duration&nbsp;</th>
											<th onclick="clickOnUserNbSessionsHeader()">Nb&nbsp;sessions&nbsp;</th>
											<th onclick="clickOnUserStartHeader()">Start&nbsp;</th>
											<th onclick="clickOnUserEndHeader()">End&nbsp;</th>
										</tr>
									</thead>
									<tbody id="userTableBody">
									</tbody>
								</table>
							</div>
						</div>
						
						<div id="Categories" class="controlTabContent">
							<div id="categoryTableArea">
								<table id="categoryTable">
									<thead>
										<tr>
											<th onclick="clickOnCategoryNameHeader()">Category</th>
											<!-- <th id="eventsPerCategoryColumn" onclick="clickOnCategoryNbEventsHeader()">Nb events</th> -->
											<th>Color</th>
										</tr>
									</thead>
									<tbody id="categoryTableBody">
									</tbody>
								</table>
							</div>
						</div>
					
					</div>
					
				</div>
				
				<div id="middle">
				
					<div id="top" class="section">
						<div id="highlightResetButtons">
							<button onclick="clearUserSelection();" class="clickable">Reset users</button>
							<button onclick="clearEventTypeSelection();" class="clickable">Reset event types</button>
						</div>
						<div class="title">Current highlights</div>
						<div class="body">
							<!-- Activity indicator, disabled for now
							<svg class="leftAligned no-margin-top no-margin-bottom" width="14.4" height="14.4">
								<circle cx="7.2" cy="7.2" r="5" stroke="black" stroke-width="1" fill="grey"/>
							</svg> -->
							<!-- <p class="leftAligned no-margin-top no-margin-bottom">Current highlights: </p> -->
							<div class="leftAligned no-margin-top no-margin-bottom" id="userHighlight">No user</div>
							<div class="leftAligned lastItem no-margin-top no-margin-bottom" id="eventTypeHighlight">No event type</div>
							<div class="rightAligned"></div>
						</div>
					</div>
				
					<div id="center" class="section">
						<div id="timeline-view">
							<div id="timeline">
								<div class="subsection">
									<div class="title">Overview</div>
									<div id="tl_overview" class="body"></div>
								</div>
								<!-- <div class="subsection">
									<div class="title">Trace exploration</div>
									<div id="tl_focusControl" class="body"></div>
								</div> -->
								<div class="subsection">
									<div class="title">All users</div>
									<div id="tl_focusControl" class="param">
										<form class="displayZoomForm">
											<input type="button" name="zoom" value="+" class="clickable" id="zoomIn" onclick="zoomingIn();"/>
											<input type="button" name="zoom" value="-" class="clickable" id="zoomOut" onclick="zoomingOut();"/>
										</form>
										<div class="focusZoomInfo">
											Data grouped by:
											<span id="zoomInfoYear" class="zoomInfoSpan clickable" onclick="goToYearDistribution();">year</span>
											<span class="zoomInfoSpan"> > </span>
											<span id="zoomInfoMonth" class="zoomInfoSpan clickable" onclick="goToMonthDistribution();">month</span>
											<span class="zoomInfoSpan"> > </span>
											<span id="zoomInfoHalfMonth" class="zoomInfoSpan clickable" onclick="goToHalfMonthDistribution();">half month</span>
											<span class="zoomInfoSpan"> > </span>
											<span id="zoomInfoDay" class="zoomInfoSpan clickable" onclick="goToDayDistribution();">day</span>
											<span class="zoomInfoSpan"> > </span>
											<span id="zoomInfoHalfDay" class="zoomInfoSpan clickable" onclick="goToHalfDayDistribution();">half day</span>
											<span class="zoomInfoSpan"> > </span>
											<span id="zoomInfoEvent" class="zoomInfoSpan clickable" onclick="goToEvents();">event</span>
										</div>
										<form id="binDisplayStyleForm" class="displayControlForm">
											<label class="hidden">Relative size: </label>
											<input id="displayBinFullHeightInput" type="checkbox" name="scale" class="clickable hidden" value="Full height" onchange="switchBinHeightDisplay();"/>
											<label>Show categories: </label>
											<input id="displayBinColorInput" type="checkbox" name="scale" class="clickable" value="Colors" onchange="switchBinCategoryDisplay();"/>
										</form>
										<form id="eventDisplayStyleForm" class="displayControlForm">
											<label>Order events by: </label>
											<label>
												Type
												<input type="radio" name="scale" class="clickable" checked value="type" onchange="startDisplayingEventsByType();"/>
											</label>
											<label class="hidden">
												Time
												<input type="radio" name="scale" class="clickable hidden" value="time" onchange="startDisplayingEventsByTime();"/>
											</label>
										</form>
										<form id="focusShowOnlyHighlightedForm">
											<label>
												Only show highlighted: 
												<input type="checkbox" name="showOnlyHighlighted" class="clickable" value="showOnlyHighlighted" onchange="switchFocusShowOnlyHighlighted();"/>
											</label>
										</form>
									</div>
									<div id="tl_focus" class="body"></div>
								</div>
								<div class="subsection">
									<div class="title">Exploration per user</div>
									<div id="tl_usersControl" class="param">
									<span>Show 
										<span id="showUserSessionsSwitch" class="switchArea">
											<button type="button" value="all" class="selectedOption" onclick="showUserSessions('all');">All users</button><button type="button" value="selected" id="showSelectedUserSessionsButton" onclick="showUserSessions('selected');">Selected users (0)</button><button type="button" value="some" onclick="showUserSessions('some');">Some users</button></span>
									</span>
									<span id="shownUserSessionsControl" class="hidden">Users shown: <span id="nbUserShownValue">&nbsp;</span><input type="range" id="nbUserShownInput"></span>
									<span id="drawIndividualEvents" class="hidden">Show events: <input type="checkbox" class="clickable" id="drawIndividualEventsInput" onchange="changeDrawIndividualEventsOnSessions();"></span>
									<span id="showOnlyHighlightedInSessions" class="hidden">Only show highlighted events: <input type="checkbox" class="clickable" id="showOnlyHighlightedInSessionsInput" onchange="refreshUserPatterns();"></span>
									</div>
									<div id="tl_users" class="body"></div>
								</div>
								<!-- <div class="subsection">
									<div class="title">Selected users</div>
									<div id="tl_selectedUsers" class="body"></div>
								</div> -->
								<!-- <div class="tl_separator"><span>Trace exploration</span></div>
								<div id="tl_focusControl"></div>
								<div id="tl_focus"></div>
								<div class="tl_separator"><span>User patterns</span></div>
								<!-- <div id="tl_usersControl"></div> -->
								<!-- <div id="tl_users"></div>
								<div class="tl_separator"><span>Selected users</span></div>
								<div id="tl_selectedUsers"></div>
								<div class="tl_separator"><span>Selected patterns</span></div>
								<div id="tl_patterns"></div> -->
							</div>
							<div id="centerOverlay">
							
							</div>
						</div>
					
					</div>
				
				</div>
					
				<div id="right">
				
					<div id="algorithmInfo" class="section">
						<div class="title">Algorithm</div>
						<ul class="algorithmTabs">
							<li><a href="javascript:void(0)" class="algorithmTabLink active" onclick="openAlgorithmTab(event, 'Execution')">Execution</a></li>
							<!-- <li><a href="javascript:void(0)" class="algorithmTabLink" onclick="openAlgorithmTab(event, 'Metrics')">Metrics</a></li> -->
							<li><a href="javascript:void(0)" class="algorithmTabLink" onclick="openAlgorithmTab(event, 'Algorithm')">Mining</a></li>
						</ul>
					
						<div id="Execution" class="algorithmTabContent defaultAlgorithmTab">
							<div>
								<p>Runtime: <span id="runtime">00:00</span> <span id="currentAlgorithmWork">(Algorithm not running)</span></p>
								<p class="algoParameterRecap">Min. support: <span id="currentSupport">??</span></p>
								<p class="algoParameterRecap">Gap interval: <span id="currentGap">??</span></p>
								<p class="algoParameterRecap">Max. duration: <span id="currentMaxDuration">??</span></p>
								<p class="algoParameterRecap">Max. size: <span id="currentSize">??</span></p>
								<p class="algoParameterRecap hidden">Window size: <span id="currentWindow">??</span></p>
								<!-- <p>Data used: <span id="dataUsed"></span></p>
								<p>Focusing on: <span id="focus"></span></p> -->
								<button onclick="toggleExtendedAlgorithmView();" class="clickable">Show more</button>
							</div>
							<div>
								
							</div>
						</div>
						<!--
						<div id="Metrics" class="algorithmTabContent">
							<p>Pattern sizes' distribution:</p>
							<div id="patternSizeDistribution">
							
							</div>
						</div>
						-->
						<div id="Algorithm" class="algorithmTabContent">
							<div id="sliderSupportArea">
								<p>Min. support:<span class="iconHelper" id="helpSupport">&nbsp;&nbsp;(?)</span></p>
								<br>
								<div id="sliderSupport"></div>
							</div>
							<div id="sliderGapArea">
								<p>Min. and max. gap:<span class="iconHelper" id="helpGap" title="Number of events in the pattern that don't belong to it">&nbsp;&nbsp;(?)</span></p>
								<br>
								<div id="sliderGap"></div>
							</div>
							<div id="sliderWindowArea">
								<p>Window:<span class="iconHelper" id="helpWindow">&nbsp;&nbsp;(?)</span></p>
								<br>
								<div id="sliderWindow"></div>
							</div>
							<div id="sliderSizeArea">
								<p>Max. size:<span class="iconHelper" id="helpSize">&nbsp;&nbsp;(?)</span></p>
								<br>
								<div id="sliderSize"></div>
							</div>
						</div>
					</div>
					
					<div id="patternArea" class="section">
					
						<div class="title">Patterns</div>
						<div class="subtitle"><span id="patternNumberSpan">0</span> discovered, <span id="selectedPatternNumberSpan">0</span> selected, <span id="highlightedPatternNumberSpan">0</span> matching the filter</div>
						<div class="param">
							<div class="left-aligned">
								Show text:
								<input type="checkbox" class="clickable" id="showPatternTextInput" checked onchange="switchShowPatternText();">
							</div>
							<div class="right-aligned">
								<button onclick="selectUsersBasedOnPatternSelection();" class="clickable">Highlight relevant users</button>
								<button onclick="unselectAllPatterns();" class="clickable">Unselect all patterns</button>
							</div>
						</div>
						<div id="patternListArea" class="body">
							<form>
								<div class="searchBarArea">
									<div class="searchFieldArea">
										&nbsp;
										<input type="text" class="searchField" placeholder="Write event types here">
										<input type="text" class="hidden" disabled> <!-- To prevent submitting the form and reloading the page -->
										<div class="suggestionDiv">
										</div>
									</div>
								</div>
							</form>
							 
							<div id="List">
								<table id="patternTable">
									<thead>
										<tr class="clickable">
											<th onclick="clickOnPatternNameHeader()">Name&nbsp;</th>
											<th onclick="clickOnPatternSupportHeader()">Support&nbsp;</th>
											<th onclick="clickOnPatternNbUsersHeader()">Nb&nbsp;users&nbsp;</th>
											<th onclick="clickOnPatternSizeHeader()">Size&nbsp;↓</th>
										</tr>
									</thead>
									<tbody id="selectedPatternTableBody">
									</tbody>
									<tr id="patternListSeparator">
										<td colspan="4"><hr></td>
									</tr>
									<tbody id="patternTableBody">
									</tbody>
								</table>
						
							</div>
						</div>
					
					</div>
				</div>
					
				<div id="tooltip" class="section hidden">
					<!-- <div class="title">Inspector</div> -->
					<div class="subtitle">Click somewhere to lock this tooltip</div>
					<div class="body">
					Hover over the visualizations to get more information
					</div>
				</div>
				<div id="algorithmExtended" class="hidden">
					<div id="algorithmExtendedMainPanel">
						<div class="section">
							<div class="body">
								<button onclick="toggleExtendedAlgorithmView();" class="clickable">Show less</button>
								<p class="right-aligned">Total: <spans>XXX</spans> patterns found over <span>YYY time</span></p>
							</div>
						</div>
						<div id="patternSizeTableArea" class="section">
							<div class="body">
								<table>
									<thead>
										<tr>
											<th>Size</th>
											<th>Status</th>
											<th>Patterns found</th>
											<th>Candidates checked</th>
											<th>Progression</th>
											<th>Elapsed time</th>
										</tr>
									</thead>
									<tbody>

									</tbody>
								</table>
							</div>
						</div>
					</div>
					<div id="algorithmExtendedSidePanel">
						<div id="extendedAlgorithmStrategyArea" class="section">
							<div class="body">
								plop
							</div>
						</div>
						<div id="algorithmSpeedArea" class="section">
							<div class="body">
								plop
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	    <script src="config.js" type="text/javascript" charset="utf-8"></script>
		<script src="ServerInterface.js" type="text/javascript" charset="utf-8"></script>
		<script src="jscolor/jscolor.js" type="text/javascript"></script> <!-- http://jscolor.com -->
		<script src="D3/d3.js" type="text/javascript"></script>
		<script src="noUiSlider/nouislider.js" type="text/javascript"></script>
		<script src="d3-symbol-extra.js" type="text/javascript"></script>
		<script src="customSymbols.js" type="text/javascript"></script>
		<script src="lz-string.js" type="text/javascript"></script>
		<script src="Crossfilter/crossfilter.js" type="text/javascript"></script>
		<script src="lodash/lodash.js" type="text/javascript"></script>
	    <script src="ClientScript.js" type="text/javascript" charset="utf-8"></script>
	</body>
</html>
